<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js" type="text/javascript"></script>
<script src="//maps.googleapis.com/maps/api/js?sensor=false" type="text/javascript"></script>
<script type="text/javascript">
  
  var coords = {
    "40.709473 -74.01125100000002" : ["images/1.jpg", "Bro, this protest is totally nuts! #thingsthataretotallynuts"],
    "40.709418 -74.01112799999999" : ["images/2.jpg", "Pretty cool, there's like medical stuff and shit"],
    "40.709363 -74.01100600000001" : ["images/3.jpg", "Lots of friendly protesters in the park!"],
    "40.709519 -74.01135299999999" : ["images/4.jpg", "MAD CLOTHES AND BLANKETS. #sleeponallthethings"],
    "40.709578 -74.011485"         : ["images/5.jpg", "Just a guy texting on a soapbox, nbd. #itreallyisntabd"],
  };
  
  var blah = {
    0 : ["40.709473", "-74.01125100000002", "images/1.jpg", "Bro, this protest is totally nuts! #thingsthataretotallynuts"],
    1 : ["40.709418"," -74.01112799999999","images/2.jpg", "Pretty cool, there's like medical stuff and shit"],
    2 : ["40.709363", "-74.01100600000001", "images/3.jpg", "Lots of friendly protesters in the park!"],
    3 : ["40.709519", "-74.01135299999999", "images/4.jpg", "MAD CLOTHES AND BLANKETS. #sleeponallthethings"],
    4 : ["40.709578", "-74.011485","images/5.jpg", "Just a guy texting on a soapbox, nbd. #itreallyisntabd"],
  }

  var sv = new google.maps.StreetViewService();  
  var panorama;
  var zuccotti;
  
  function initialize() {
    zuccotti = new google.maps.LatLng(40.709385,-74.011323);
    var panoramaOptions = {
      position: zuccotti,
      pov: {
        heading: 34,
        pitch: 10,
        zoom: 1
      }
    };
    panorama = new google.maps.StreetViewPanorama(document.getElementById("pano"),panoramaOptions);
    google.maps.event.addListener(panorama, 'position_changed', function() {
         position = panorama.getPosition();
         concatPos = position['Pa'] + " " + position['Qa'];
         $("#overlay").attr("src", coords[concatPos][0]);
         $("#tweet").html(coords[concatPos][1]);
     });
  }
  
  
  var setPanorama = function(lat, lng){
   zuccotti = new google.maps.LatLng(lat,lng);
   sv.getPanoramaByLocation(zuccotti, 50, processSVData);
  }
    
  var processSVData = function(data, status) {
      if (google.maps.StreetViewStatus.OK) {    
        console.log(data)
        panorama.setPano(data.location.pano);
        panorama.setPov({
          heading: 270,
          pitch: 0,
          zoom: 1
        });
        panorama.setVisible(true);
      }
   }
   
   var loop = function(index){
     (index == 4) ? index = 0 : index++;
     setPanorama(blah[index][0], blah[index][1])
     setTimeout(function(){loop(index)}, 2000);  
   }
   
   loop(0)
   
</script>
</head>
<body onload="initialize()">
  <div id="pano" style="width: 1200px; height: 600px;"></div>
  <img id="overlay" src=""/>
  <div id="tweet"></div>
</body>
</html>


